<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Election Commissioner Admin</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      min-height: 100vh;
      background: linear-gradient(135deg, #f9fafb, #eef2f7);
      color: #333;
    }

    .container { display: flex; width: 100%; }

    /* Sidebar */
    .sidebar {
      width: 240px;
      background: #ffffff;
      border-right: 1px solid #e5e7eb;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 20px 10px;
      transition: all 0.3s ease;
      box-shadow: 2px 0 8px rgba(0, 0, 0, 0.05);
    }

    .logo {
      font-size: 20px;
      font-weight: bold;
      text-align: center;
      margin-bottom: 30px;
      color: #2563eb;
    }

    .nav .tab {
      padding: 12px 16px;
      margin: 8px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 15px;
      background: #f3f4f6;
      color: #374151;
      text-align: center;
    }

    .nav .tab:hover { background: #e5e7eb; }
    .nav .active {
      background: #2563eb;
      color: #fff;
      font-weight: bold;
      box-shadow: 0 2px 6px rgba(37, 99, 235, 0.3);
    }

    .logout {
      padding: 12px 16px;
      margin: 8px;
      text-align: center;
      border-radius: 8px;
      background: #ef4444;
      color: #fff;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s;
    }
    .logout:hover { background: #dc2626; }

    /* Content */
    .content {
      flex: 1;
      padding: 30px;
      background: #f9fafb;
      overflow-y: auto;
    }
    .content h1 { font-size: 26px; margin-bottom: 15px; color: #1f2937; }
    .content p { color: #6b7280; margin-bottom: 20px; }

    /* Form */
    .form-container {
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      max-width: 600px;
      margin: 20px auto;
    }
    .form-group { margin-bottom: 15px; }
    .form-group label {
      display: block;
      font-weight: 600;
      margin-bottom: 6px;
      color: #374151;
    }
    .form-group input,
    .form-group textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      font-size: 15px;
    }
    .form-group input[type="file"] { padding: 5px; }
    .form-group textarea { resize: none; }

    .submit-button {
      background: #2563eb;
      color: white;
      font-weight: 600;
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s, transform 0.2s;
    }
    .submit-button:hover { background: #1d4ed8; transform: scale(1.05); }

    /* Tables */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
      background: white;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }
    table th, table td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid #e5e7eb;
    }
    table th { background: #f3f4f6; font-weight: 600; }
    table tr:hover { background: #f9fafb; }

    .candidate-photo {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid #e5e7eb;
    }

    .voted-badge {
      background: #d1fae5;
      color: #065f46;
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 13px;
      font-weight: 600;
    }
    .not-voted-badge {
      background: #fee2e2;
      color: #991b1b;
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 13px;
      font-weight: 600;
    }

    .save-button,
    .delete-button {
      margin-top: 20px;
      display: inline-block;
      background: #10b981;
      color: white;
      padding: 10px 20px;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      border: none;
      transition: background 0.3s, transform 0.2s;
    }
    .save-button:hover { background: #059669; transform: scale(1.05); }
    .delete-button {
      background: #ef4444;
      margin-top: 15px;
    }
    .delete-button:hover { background: #dc2626; }

    /* Responsive */
    @media (max-width: 768px) {
      .container { flex-direction: column; }
      .sidebar {
        flex-direction: row;
        overflow-x: auto;
        width: 100%;
        padding: 10px;
        justify-content: space-around;
      }
      .nav { display: flex; flex-direction: row; gap: 8px; }
      .nav .tab { flex: 1; padding: 10px; font-size: 14px; text-align: center; }
      .logout { margin: 0; font-size: 14px; padding: 10px; }
      .content { padding: 20px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <aside class="sidebar">
      <div>
        <div class="logo">üó≥Ô∏è Admin Panel</div>
        <div class="nav">
          <div class="tab active" onclick="changeTab(this, 'dashboard')">üìä Dashboard</div>
          <div class="tab" onclick="changeTab(this, 'voters')">üßë‚Äçü§ù‚Äçüßë Voters</div>
          <div class="tab" onclick="changeTab(this, 'stats')">üìà Stats</div>
          <div class="tab" onclick="changeTab(this, 'settings')">‚öôÔ∏è Reset</div>
        </div>
      </div>
      <div class="logout" onclick="logout()">üö™ Logout</div>
    </aside>
    <main class="content" id="mainContent">
      <h1>Welcome to the Dashboard</h1>
      <p>This is your main admin area. Choose a tab to explore different sections.</p>
    </main>
  </div>

  <script>
    function changeTab(element, section) {
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      element.classList.add('active');

      const content = document.getElementById('mainContent');
      switch (section) {
        case 'dashboard':
          content.innerHTML = `
            <h1>üìä Dashboard</h1>
            <p>Add the details of the Candidates:</p>
            <form id="dashboardForm" class="form-container" enctype="multipart/form-data">
              <div class="form-group">
                <label for="name">Candidate Name</label>
                <input type="text" id="name" name="name" placeholder="Enter candidate's name" required />
              </div>
              <div class="form-group">
                <label for="party">Party Name</label>
                <input type="text" id="party" name="party" placeholder="Enter party name" required />
              </div>
              <div class="form-group">
                <label for="photo">Election Symbol</label> <!-- renamed -->
                <input type="file" id="photo" name="photo" accept="image/*" required />
              </div>
              <div class="form-group">
                <label for="description">Description</label>
                <textarea id="description" name="description" placeholder="Enter a description" rows="4" required></textarea>
              </div>
              <button type="submit" class="submit-button">Submit</button>
            </form>
          `;

          document.getElementById('dashboardForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            const formData = new FormData(this);
            const response = await fetch('/add-candidate', { method: 'POST', body: formData });
            const result = await response.json();
            alert(result.success ? '‚úÖ Candidate added successfully!' : (result.message || '‚ùå Failed to add candidate.'));
          });
          break;

        case 'voters':
          fetch('/get-voters')
            .then(response => response.json())
            .then(data => {
              const votersTable = `
                <h1>üßë‚Äçü§ù‚Äçüßë Voters</h1>
                <table>
                  <thead>
                    <tr><th>Name</th><th>Username</th><th>Email</th><th>Status</th></tr>
                  </thead>
                  <tbody>
                    ${data.map(voter => `
                      <tr>
                        <td>${voter.name}</td>
                        <td>${voter.username}</td>
                        <td>${voter.email}</td>
                        <td>
                          <span class="${voter.voted ? 'voted-badge' : 'not-voted-badge'}">
                            ${voter.voted ? 'Voted' : 'Not Voted'}
                          </span>
                        </td>
                      </tr>
                    `).join('')}
                  </tbody>
                </table>
              `;
              content.innerHTML = votersTable;
            })
            .catch(() => { content.innerHTML = '<p style="color: red;">‚ùå Error loading voters data.</p>'; });
          break;

        case 'stats':
          fetch('/get-stats')
            .then(response => response.json())
            .then(data => {
              const statsTable = `
                <h1>üìà Statistics</h1>
                <table>
                  <thead>
                    <tr>
                      <th>Name</th>
                      <th>Election Symbol</th> <!-- renamed -->
                      <th>Party Name</th>
                      <th>Votes</th>
                    </tr>
                  </thead>
                  <tbody>
                    ${data.map(candidate => `
                      <tr>
                        <td>${candidate.name}</td>
                        <td><img src="${candidate.photo}" alt="Election Symbol" class="candidate-photo" /></td>
                        <td>${candidate.party}</td>
                        <td>${candidate.votes}</td>
                      </tr>
                    `).join('')}
                  </tbody>
                </table>
                <button onclick="saveResults()" class="save-button">üíæ Save Results</button>
              `;
              content.innerHTML = statsTable;
            })
            .catch(() => { content.innerHTML = '<p style="color: red;">‚ùå Error loading statistics.</p>'; });
          break;

        case 'settings':
          content.innerHTML = `
            <div>
              <h1>‚öôÔ∏è Settings</h1>
              <p>Configure system preferences and controls.</p>
              <button onclick="deleteElection()" class="delete-button">üóëÔ∏è Delete Election</button>
            </div>
          `;
          break;
      }
    }

    async function saveResults() {
      try {
        const response = await fetch('/save-results', { method: 'POST' });
        const result = await response.json();
        alert(result.success ? '‚úÖ Results saved successfully!' : (result.message || '‚ùå Failed to save results.'));
      } catch { alert('üö´ Error saving results.'); }
    }

    async function deleteElection() {
      if (!confirm('‚ö†Ô∏è Are you sure you want to delete all election data?')) return;
      try {
        const response = await fetch('/delete-election', { method: 'POST' });
        const result = await response.json();
        alert(result.success ? 'üóëÔ∏è Election data deleted!' : (result.message || '‚ùå Failed to delete data.'));
      } catch { alert('üö´ Error deleting election data.'); }
    }

    function logout() { window.location.href = '/'; }
  </script>
</body>
</html>
